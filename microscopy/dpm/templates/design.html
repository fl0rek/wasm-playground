{# templates/design.html #}
<!DOCTYPE html>
<html>
<head>
    <title>Design of a Diffraction Phase Microscope</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

    <h1>Diffraction Phase Microscope - Design Document</h1>

    <h2>Inputs</h2>
    <table>
        <tr>
            <th>Component</th>
            <th>Property</th>
            <th>Value</th>
            <th>Units</th>
        </tr>
        <tr>
            <td>Objective</td>
            <td>Magnification</td>
            <td>{{ inputs["objective.magnification"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Objective</td>
            <td>Numerical Aperture</td>
            <td>{{ inputs["objective.numerical_aperture"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Camera</td>
            <td>Pixel size</td>
            <td>{{ inputs["camera.pixel_size"] }}</td>
            <td>{{ inputs["camera.pixel_size.units"] }}</td>
        </tr>
        <tr>
            <td>Camera</td>
            <td>Number of pixels (horizontal)</td>
            <td>{{ inputs["camera.horizontal_number_of_pixels"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Camera</td>
            <td>Number of pixels (vertical)</td>
            <td>{{ inputs["camera.vertical_number_of_pixels"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Light source</td>
            <td>Wavelength</td>
            <td>{{ inputs["light_source.wavelength"] }}</td>
            <td>{{ inputs["light_source.wavelength.units"] }}</td>
        </tr>
        <tr>
            <td>Grating</td>
            <td>Period</td>
            <td>{{ inputs["grating.period"] }}</td>
            <td>{{ inputs["grating.period.units"] }}</td>
        </tr>
        <tr>
            <td>Fourier lens 1</td>
            <td>Focal length</td>
            <td>{{ inputs["lens_1.focal_length"] }}</td>
            <td>{{ inputs["lens_1.focal_length.units"] }}</td>
        </tr>
        <tr>
            <td>Fourier lens 1</td>
            <td>Clear aperture</td>
            <td>{{ inputs["lens_1.clear_aperture"] }}</td>
            <td>{{ inputs["lens_1.clear_aperture.units"] }}</td>
        </tr>
        <tr>
            <td>Fourier lens 2</td>
            <td>Focal length</td>
            <td>{{ inputs["lens_2.focal_length"] }}</td>
            <td>{{ inputs["lens_2.focal_length.units"] }}</td>
        </tr>
        <tr>
            <td>Fourier lens 2</td>
            <td>Clear aperture</td>
            <td>{{ inputs["lens_2.clear_aperture"] }}</td>
            <td>{{ inputs["lens_2.clear_aperture.units"] }}</td>
        </tr>
        <tr>
            <td>Pinhole</td>
            <td>Diameter</td>
            <td>{{ inputs["pinhole.diameter"] }}</td>
            <td>{{ inputs["pinhole.diameter.units"] }}</td>
        </tr>
    </table>

    <h2>Calculated Properties</h2>
    <table>
        <tr>
            <th>Equation</th>
            <th>Property</th>
            <th>Value</th>
            <th>Units</th>
        </tr>
        <tr>
            <td>{{ results.resolution.equation }}</td>
            <td>{{ results.resolution.name }}</td>
            <td>{{ results.resolution.value }}</td>
            <td>{{ results.resolution.units }}</td>
        </tr>
        <tr>
            <td>Camera diagonal size</td>
            <td>{{ results["camera_diagonal"] }}</td>
            <td>{{ results["camera_diagonal.units"] }}</td>
        </tr>
        <tr>
            <td>Field of view (horizontal; object space)</td>
            <td>{{ results["field_of_view_horizontal"] }}</td>
            <td>{{ results["field_of_view_horizontal.units"] }}</td>
        </tr>
        <tr>
            <td>Field of view (vertical; object space)</td>
            <td>{{ results["field_of_view_vertical"] }}</td>
            <td>{{ results["field_of_view_vertical.units"] }}</td>
        </tr>
        <tr>
            <td>Maximum grating period</td>
            <td>{{ results["maximum_grating_period"] }}</td>
            <td>{{ results["maximum_grating_period.units"] }}</td>
        </tr>
        <tr>
            <td>Fourier plane spacing</td>
            <td>{{ results["fourier_plane_spacing"] }}</td>
            <td>{{ results["fourier_plane_spacing.units"] }}</td>
        </tr>
        <tr>
            <td>Minimum NA of Fourier lens 1</td>
            <td>{{ results["minimum_lens_1_na"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Actual NA of Fourier lens 1</td>
            <td>{{ results["lens_1_na"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Minimum NA of Fourier lens 2</td>
            <td>{{ results["minimum_lens_2_na"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Actual NA of Fourier lens 2</td>
            <td>{{ results["lens_2_na"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Minimum 4f magnification (absolute value)</td>
            <td>{{ results["minimum_4f_magnification"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Actual 4f magnification</td>
            <td>{{ results["4f_magnification"] }}</td>
            <td></td>
        </tr>
        <tr>
            <td>Maximum pinhole diameter</td>
            <td>{{ results["maximum_pinhole_diameter"] }}</td>
            <td>{{ results["maximum_pinhole_diameter.units"] }}</td>
        </tr>
        <tr>
            <td>Coupling ratio</td>
            <td>{{ results["coupling_ratio"] }}</td>
            <td></td>
        </tr>
    </table>

    <h2>Design Violations</h2>
    <ul>
        {% for violation in violations %}
        <li>{{violation}}</li>
        {% endfor %}
    </ul>

    <h2>Sampling Requirements</h2>
    <p>The following table provides results on the minimum resolution and maximum pixel size given the grating period, objective magnification, and 4f magnification.</p>
    <table>
        <tr>
            <th>Property</th>
            <th>Value</th>
            <th>Units</th>
        </tr>
        <tr>
            <td>Minimum resolution</td>
            <td>{{ results["minimum_resolution"] }}</td>
            <td>{{ results["minimum_resolution.units"] }}</td>
        </tr>
        <tr>
            <td>Maximum pixel size</td>
            <td>{{ results["maximum_pixel_size"] }}</td>
            <td>{{ results["maximum_pixel_size.units"] }}</td>
        </tr>
    </table>

</body>
</html>
